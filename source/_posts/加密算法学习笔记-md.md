---
title: 加密算法学习笔记.md
math: false
date: 2025-11-23 12:49:05
categories: 
tags:
    - 密码学
cover_picture: images/openssl.png
---

最近回顾了自己读大学的时候做的一些加解密工具, 发现已经使用不同的语言实现过很多次AES加解密逻辑了. 虽然基于各种编程语言自带的加密算法库, 实现一个加解密功能并不算复杂, 但是其中的许多实现逻辑比较繁琐, 处理不当容易产生安全问题. 

正好这个时候想到Unix设计哲学里面的一个工具只做一件事, 于是就查询了一下有无那个工具能够在命令行上面搞定加解密的事情. 经过简单地查询, 可以发现一个名叫`openssl`的工具已经很好的实现了相关的功能. 因此本文将基于此工具讨论一些常见的加密算法, 后续有需要加解密的场景就可以直接使用此工具来实现, 而不必重复造轮子了.




对称加密
---------------

对称加密的经典算法是AES算法, `openssl`内置了多种AES算法的模式, 具体对比如下


# AES工作模式详细对比表

| 模式    | 全称                       | 主要原理                                 | 认证加密   | 并行加密   | 需要填充   | 错误传播     | IV要求       | 推荐程度     | 典型场景           |
| ------- | -------------------------- | ---------------------------------------- | ---------- | ---------- | ---------- | ------------ | ------------ | ------------ | ------------------ |
| **ECB** | Electronic Codebook        | 每个数据块独立加密，相同明文产生相同密文 | ❌ 无       | ✅ 支持     | ✅ 需要     | 块内传播     | ❌ 无需       | ❌ 永不使用   | 基本不应使用       |
| **CBC** | Cipher Block Chaining      | 每个块与前一密文块异或后再加密           | ❌ 无       | ❌ 不支持   | ✅ 需要     | 影响后续块   | ✅ 随机唯一   | ✅ 传统兼容   | 文件加密、传统协议 |
| **CTR** | Counter                    | 使用计数器生成密钥流，与明文异或         | ❌ 无       | ✅ 支持     | ❌ 不需要   | 仅影响当前位 | ✅ 唯一计数器 | ✅✅ 推荐      | 磁盘加密、大文件   |
| **OFB** | Output Feedback            | 将块密码转换为自同步流密码               | ❌ 无       | ❌ 不支持   | ❌ 不需要   | 仅影响当前位 | ✅ 随机唯一   | ⚠️ 一般       | 错误敏感场景       |
| **CFB** | Cipher Feedback            | 将块密码转换为自同步流密码，密文反馈     | ❌ 无       | ❌ 不支持   | ❌ 不需要   | 有限传播     | ✅ 随机唯一   | ⚠️ 一般       | 字节级流加密       |
| **GCM** | Galois/Counter Mode        | CTR模式加密 + GMAC认证                   | ✅ 内置认证 | ✅ 支持     | ❌ 不需要   | 认证失败     | ✅ 随机唯一   | ✅✅✅ 强烈推荐 | TLS、现代加密      |
| **CCM** | Counter with CBC-MAC       | CTR加密 + CBC-MAC认证                    | ✅ 内置认证 | ⚠️ 有限并行 | ❌ 不需要   | 认证失败     | ✅ 随机唯一   | ✅✅ 推荐      | 无线通信、物联网   |
| **XTS** | XEX-based Tweaked Codebook | 专为磁盘加密设计，使用tweak值            | ❌ 无       | ✅ 支持     | ⚠️ 部分需要 | 仅影响扇区   | ✅ tweak值    | ✅✅ 专用场景  | 全盘加密           |

## OpenSSL命令行示例汇总

```bash
# CBC模式（兼容性好）
openssl enc -aes-256-cbc -pbkdf2 -iter 100000 -salt -in file.txt -out file.cbc

# CTR模式（高性能，无填充）
openssl enc -aes-256-ctr -pbkdb2 -iter 100000 -salt -in file.txt -out file.ctr

# GCM模式（推荐，认证加密）
openssl enc -aes-256-gcm -pbkdf2 -iter 100000 -salt -in file.txt -out file.gcm

# 查看支持的加密算法列表
openssl enc -list
```
